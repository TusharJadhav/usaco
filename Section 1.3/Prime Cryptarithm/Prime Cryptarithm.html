<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="1504.83">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; text-align: center; line-height: 43.0px; font: 37.0px Times; color: #000000; -webkit-text-stroke: #000000}
    p.p2 {margin: 0.0px 0.0px 12.0px 0.0px; line-height: 14.0px; font: 12.0px Times; color: #000000; -webkit-text-stroke: #000000}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; line-height: 14.0px; font: 12.0px Courier; color: #000000; -webkit-text-stroke: #000000}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; line-height: 14.0px; font: 12.0px Times; color: #000000; -webkit-text-stroke: #000000}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; line-height: 14.0px; font: 12.0px Courier; color: #000000; -webkit-text-stroke: #000000; min-height: 14.0px}
    span.s1 {font-kerning: none}
    table.t1 {border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #808080 #808080 #808080 #808080}
    td.td1 {width: 34.3px; margin: 0.5px 0.5px 0.5px 0.5px; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #808080 #808080 #808080 #808080; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td2 {width: 335.9px; margin: 0.5px 0.5px 0.5px 0.5px; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #808080 #808080 #808080 #808080; padding: 1.0px 1.0px 1.0px 1.0px}
  </style>
</head>
<body>
<p class="p1"><span class="s1"><b>Prime Cryptarithm</b></span></p>
<p class="p2"><span class="s1">The following cryptarithm is a multiplication problem that can be solved by substituting digits from a specified set of N digits into the positions marked with *. If the set of prime digits {2,3,5,7} is selected, the cryptarithm is called a PRIME CRYPTARITHM.</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">      </span>* * *</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">   </span>x<span class="Apple-converted-space">    </span>* *</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">    </span>-------</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">      </span>* * * <span class="Apple-converted-space">        </span>&lt;-- partial product 1</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">    </span>* * * <span class="Apple-converted-space">          </span>&lt;-- partial product 2</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">    </span>-------</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">    </span>* * * *</span></p>
<p class="p4"><span class="s1">Digits can appear only in places marked by `*'. Of course, leading zeroes are not allowed.</span></p>
<p class="p2"><span class="s1"><b>The partial products must be three digits long</b>, even though the general case (see below) might have four digit partial products. <br>
<br>
********** Note About Cryptarithm's Multiplication ************ <br>
In USA, children are taught to perform multidigit multiplication as described here. Consider multiplying a three digit number whose digits are 'a', 'b', and 'c' by a two digit number whose digits are 'd' and 'e':</span></p>
<p class="p3"><span class="s1">[Note that this diagram shows far more digits in its results than</span></p>
<p class="p3"><span class="s1">the required diagram above which has three digit partial products!]</span></p>
<p class="p5"><span class="s1"></span><br></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">          </span>a b c <span class="Apple-converted-space">    </span>&lt;-- number 'abc'</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">        </span>x <span class="Apple-converted-space">  </span>d e <span class="Apple-converted-space">    </span>&lt;-- number 'de'; the 'x' means 'multiply'</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">     </span>-----------</span></p>
<p class="p3"><span class="s1">p1<span class="Apple-converted-space">      </span>* * * * <span class="Apple-converted-space">    </span>&lt;-- product of e * abc; first star might be 0 (absent)</span></p>
<p class="p3"><span class="s1">p2<span class="Apple-converted-space">    </span>* * * * <span class="Apple-converted-space">      </span>&lt;-- product of d * abc; first star might be 0 (absent)</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">     </span>-----------</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">      </span>* * * * * <span class="Apple-converted-space">    </span>&lt;-- sum of p1 and p2 (e*abc + 10*d*abc) == de*abc</span></p>
<p class="p5"><span class="s1"></span><br></p>
<p class="p2"><span class="s1">Note that the 'partial products' are as taught in USA schools. The first partial product is the product of the final digit of the second number and the top number. The second partial product is the product of the first digit of the second number and the top number.</span></p>
<p class="p2"><span class="s1">Write a program that will find all solutions to the cryptarithm above for any subset of supplied non-zero single-digits.</span></p>
<h3 style="margin: 0.0px 0.0px 14.0px 0.0px; line-height: 17.0px; font: 14.0px Times; color: #000000; -webkit-text-stroke: #000000"><span class="s1"><b>PROGRAM NAME: crypt1</b></span></h3>
<h3 style="margin: 0.0px 0.0px 14.0px 0.0px; line-height: 17.0px; font: 14.0px Times; color: #000000; -webkit-text-stroke: #000000"><span class="s1"><b>INPUT FORMAT</b></span></h3>
<table cellspacing="0" cellpadding="0" class="t1">
  <tbody>
    <tr>
      <td valign="middle" class="td1">
        <p class="p4"><span class="s1">Line 1:</span></p>
      </td>
      <td valign="middle" class="td2">
        <p class="p4"><span class="s1">N, the number of digits that will be used</span></p>
      </td>
    </tr>
    <tr>
      <td valign="middle" class="td1">
        <p class="p4"><span class="s1">Line 2:</span></p>
      </td>
      <td valign="middle" class="td2">
        <p class="p4"><span class="s1">N space separated non-zero digits with which to solve the cryptarithm</span></p>
      </td>
    </tr>
  </tbody>
</table>
<h3 style="margin: 0.0px 0.0px 14.0px 0.0px; line-height: 17.0px; font: 14.0px Times; color: #000000; -webkit-text-stroke: #000000"><span class="s1"><b>SAMPLE INPUT (file crypt1.in)</b></span></h3>
<p class="p3"><span class="s1">5</span></p>
<p class="p3"><span class="s1">2 3 4 6 8</span></p>
<h3 style="margin: 0.0px 0.0px 14.0px 0.0px; line-height: 17.0px; font: 14.0px Times; color: #000000; -webkit-text-stroke: #000000"><span class="s1"><b>OUTPUT FORMAT</b></span></h3>
<p class="p2"><span class="s1">A single line with the total number of solutions. Here is the single solution for the sample input:</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">      </span>2 2 2</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">    </span>x <span class="Apple-converted-space">  </span>2 2</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">     </span>------</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">      </span>4 4 4</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">    </span>4 4 4</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">  </span>---------</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">    </span>4 8 8 4</span></p>
<h3 style="margin: 0.0px 0.0px 14.0px 0.0px; line-height: 17.0px; font: 14.0px Times; color: #000000; -webkit-text-stroke: #000000"><span class="s1"><b>SAMPLE OUTPUT (file crypt1.out)</b></span></h3>
<p class="p3"><span class="s1">1</span></p>
</body>
</html>
